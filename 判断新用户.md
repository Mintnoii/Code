判断新用户

```jsx
/**
 * 判断用户新用户属性
 * 返回值： 
 * 0：非纯新、非新用户
 * 1：纯新 0天用户
 * N：1-15天内的用户,返回天数
 * @date   2019-07-12T20:51:51+0800
 * @param  {string}                 createDate 
 */
import moment from 'nuke-biz-moment';
import { StorageOper } from 'Biz/View/StorageOper.jsx';
// import { Modal } from 'nuke';
var checkNewUser = function(createDate, callback) {
    if (createDate == undefined || typeof(createDate) != 'string' || createDate == '') {
        // 未传入createDate 取数据 异步返回
        if (callback == undefined) {
            return 0;
        } else {
            StorageOper.localGet({
                key: 'createdate,vipflag',
                callback: (res) => {
                    if (res.createdate != undefined && res.createdate != '') {
                        callback(checkNewUser(res.createdate));
                    } else {
                        callback(0);
                    }
                }
            });
        }
    } else {
        // 传入createDate 同步返回数据
        try {
            // 当前日期
            let currentDateStr = moment().format('YYYY-MM-DD');
            let todayTime = new Date().getTime();
            // Modal.alert(createDate);
            if (currentDateStr) {
                currentDateStr = currentDateStr.replace(/\//g, '-');
                // 判断createDate的格式 可能是2019-01-01 11:11:11的格式
                if (currentDateStr == createDate || currentDateStr == createDate.substr(0, 10)) {
                    return 1;
                } 
                // 判断是否是15天内 update 计算天数按照自然日算
                let diffDays = 0;
                if (createDate) {
                    // diffDays = Math.ceil((todayTime - new Date(createDate.replace(/-/g, '/')).getTime()) / 1000 / 60 / 60 / 24);
                    let todayStartTime = new Date(currentDateStr).getTime();
                    let createDateStartTime = new Date(createDate.replace(/-/g, '/').substr(0, 10)).getTime();
                    // let createDateStartTime = new Date('2019-07-21 23:59:00'.replace(/-/g, '/').substr(0, 10)).getTime();
                    diffDays = Math.ceil((todayStartTime - createDateStartTime) / 1000 / 60 / 60 / 24);
                }
                if (diffDays <= 15) {
                    return diffDays;
                }
            }
            return 0;
        } catch(e) {
            // 防止报错
            console.error('校验新用户出现异常！', JSON.stringify(e));
            return 0;
        }
    }
};

export { checkNewUser };

```

